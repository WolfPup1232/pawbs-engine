<!DOCTYPE html>
<html lang="en">
<head>
	
	<!-- HTML Metadata -->
    <meta charset="UTF-8">
    <title>Game</title>
	
	
	<!-- Third-Party Imports - Bootstrap & jQuery -->
	<link href="./libraries/bootstrap/bootstrap.min.css" rel="stylesheet">
	<link href="./libraries/bootstrap/bootstrap-icons.min.css" rel="stylesheet">
	<script src="./libraries/bootstrap/bootstrap.bundle.min.js"></script>
	<script src="./libraries/jquery/jquery-3.7.1.min.js"></script>
	
	<!-- Game CSS -->
	<link rel="stylesheet" href="./style.css">
	
</head>
<body>
	
	<!-- Special UIs -->
	
	<!-- Debug UI -->
	<div id="debug" class="mx-3" style="display: none;">
		<div class="row">
			<div class="debug-window col">
				<div class="card mt-3 shadow-sm">
					<div class="card-body">
						<p class="card-title small fw-bold">Debug Info</p>
						<p id="debug-text" class="card-text small mb-1"></p>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	
	<!-- Editor UI -->
	<div id="editor" class="mx-3" style="display: none;">
		
		<!-- Editor Title Window / Spawn Objects -->
		<div id="editor-title" class="row">
			<div class="editor-window col-12 col-lg-7 col-xl-5">
				<div class="card p-2 mt-3 shadow-sm">
					<div class="input-group">
						<div class="card-title fw-bold input-group-text w-100 m-0">
							
							<!-- Editor Title -->
							Edit World
							
							<div class="vr ms-3"></div>
							
							<!-- World Name -->
							<input id="editor-world-name" class="form-control form-control-sm w-auto mx-3" placeholder="Enter your world's name." type="text"
							data-bs-title="Enter your world's name." data-bs-toggle="tooltip" data-bs-placement="bottom">
							
							<div class="vr me-3"></div>
							
							<!-- New/Load/Save World -->
							<button id="editor-world-new" type="button" class="btn btn-sm btn-outline-secondary ms-0 me-1"
							data-bs-title="Create a new world." data-bs-toggle="tooltip" data-bs-placement="bottom">
								<i class="bi bi-file-earmark"></i>
							</button>
							<button id="editor-world-load" type="button" class="btn btn-sm btn-outline-secondary mx-1"
							data-bs-title="Import world from JSON." data-bs-toggle="tooltip" data-bs-placement="bottom">
								<i class="bi bi-folder2-open"></i>
							</button>
							<button id="editor-world-save" type="button" class="btn btn-sm btn-outline-secondary ms-1 me-0"
							data-bs-title="Export world to JSON." data-bs-toggle="tooltip" data-bs-placement="bottom">
								<i class="bi bi-floppy"></i>
							</button>
							
							<div class="vr mx-3"></div>
							
							<!-- Spawn Objects -->
							<button id="editor-world-geometry-billboard" type="button" class="btn btn-sm btn-outline-secondary ms-0 me-1"
							data-bs-title="Spawn a new billboard object." data-bs-toggle="tooltip" data-bs-placement="bottom">
								<i class="bi bi-image"></i>
							</button>
							<button id="editor-world-geometry-plane" type="button" class="btn btn-sm btn-outline-secondary mx-1"
							data-bs-title="Spawn a new plane object." data-bs-toggle="tooltip" data-bs-placement="bottom">
								<i class="bi bi-square"></i>
							</button>
							<button id="editor-world-geometry-box" type="button" class="btn btn-sm btn-outline-secondary mx-1"
							data-bs-title="Spawn a new box object." data-bs-toggle="tooltip" data-bs-placement="bottom">
								<i class="bi bi-box"></i>
							</button>
							<button id="editor-world-geometry-cylinder" type="button" class="btn btn-sm btn-outline-secondary mx-1"
							data-bs-title="Spawn a new cylinder object." data-bs-toggle="tooltip" data-bs-placement="bottom">
								<i class="bi bi-database"></i>
							</button>
							<button id="editor-world-geometry-sphere" type="button" class="btn btn-sm btn-outline-secondary mx-1"
							data-bs-title="Spawn a new sphere object." data-bs-toggle="tooltip" data-bs-placement="bottom">
								<i class="bi bi-globe"></i>
							</button>
							
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<!-- Selected Objects Window -->
		<div id="editor-selected-objects" class="row" style="display: none;">
			<div class="editor-window col-6 col-md-5 col-lg-4 col-xl-2 overflow-hidden">
				<div id="editor-selected-objects-inner" class="card pt-2 ps-2 pe-2 pb-2 mt-3 shadow-sm">
					<div class="accordion">
						
						<!-- Transform -->
						<div class="accordion-item">
							
							<!-- Transform Title -->
							<div class="card-title accordion-title w-100 mb-0">
								<button class="accordion-button collapsed small-important fw-bold p-0 m-0" type="button" data-bs-toggle="collapse" data-bs-target="#editor-selected-objects-transform" aria-expanded="true" aria-controls="editor-selected-objects-transform">
									<span data-bs-title="Move/scale/rotate objects." data-bs-toggle="tooltip" data-bs-placement="bottom">
										Transform
									</span>
								</button>
							</div>
							
							<div id="editor-selected-objects-transform" class="accordion-collapse collapse show p-2">
								
								<!-- Transform Modes -->
								<div id="editor-selected-objects-transform-modes" class="pb-2 mb-2 border-bottom">
									<div class="d-flex">
										<div class="mx-1">
											<input id="editor-selected-objects-transform-position-radio" name="editor-selected-objects-transforms" class="btn-check" value="position" type="radio" checked>
											<label for="editor-selected-objects-transform-position-radio" class="btn btn-outline-secondary px-1 py-0"
											data-bs-title="Move selected objects." data-bs-toggle="tooltip" data-bs-placement="bottom">
												<i class="bi bi-arrows-move"></i>
											</label>
										</div>
										
										<div class="mx-1">
											<input id="editor-selected-objects-transform-scale-radio" name="editor-selected-objects-transforms" class="btn-check" value="scale" type="radio">
											<label for="editor-selected-objects-transform-scale-radio" class="btn btn-outline-secondary px-1 py-0"
											data-bs-title="Scale selected objects." data-bs-toggle="tooltip" data-bs-placement="bottom">
												<i class="bi bi-arrows-angle-expand"></i>
											</label>
										</div>
										
										<div class="mx-1">
											<input id="editor-selected-objects-transform-rotation-radio" name="editor-selected-objects-transforms" class="btn-check" value="rotation" type="radio">
											<label for="editor-selected-objects-transform-rotation-radio" class="btn btn-outline-secondary px-1 py-0"
											data-bs-title="Rotate selected objects." data-bs-toggle="tooltip" data-bs-placement="bottom">
												<i class="bi bi-arrow-clockwise"></i>
											</label>
										</div>
									</div>
								</div>
									
								<!-- Transform Position -->
								<div id="editor-selected-objects-transform-position" class="mb-2">
									
									<!-- Transform Position Inputs -->
									<div class="d-flex flex-wrap flex-sm-nowrap justify-content-center mb-3">
										<div class="flex-fill mx-1">
											<label class="mt-1 small">X: </label>
											<input id="editor-selected-objects-transform-position-x" class="number-input form-control form-control-sm" placeholder="X" type="text"
											data-bs-title="X-axis position." data-bs-toggle="tooltip">
										</div>
										<div class="flex-fill mx-1">
											<label class="mt-1 small">Y: </label>
											<input id="editor-selected-objects-transform-position-y" class="number-input form-control form-control-sm" placeholder="Y" type="text"
											data-bs-title="Y-axis position." data-bs-toggle="tooltip">
										</div>
										<div class="flex-fill mx-1">
											<label class="mt-1 small">Z: </label>
											<input id="editor-selected-objects-transform-position-z" class="number-input form-control form-control-sm" placeholder="Z" type="text"
											data-bs-title="Z-axis position." data-bs-toggle="tooltip">
										</div>
									</div>
									
									<!-- Transform Position Snap-To-Grid -->
									<div class="d-flex flex-row-reverse">
										<div class="text-end">
											<input id="editor-selected-objects-transform-position-snap-checkbox" class="btn-check float-end" type="checkbox" checked>
											<label for="editor-selected-objects-transform-position-snap-checkbox" class="btn btn-outline-secondary px-1 py-0 mt-2px float-end"
											data-bs-title="Enable/disable snap-to-grid." data-bs-toggle="tooltip" data-bs-placement="bottom">
												<i class="bi bi-grid-3x3"></i>
											</label>
											<input id="editor-selected-objects-transform-position-snap" class="form-control form-control-sm w-36px px-1 mx-1 float-end" type="text"
											data-bs-title="Snap-to-grid distance." data-bs-toggle="tooltip" data-bs-placement="bottom">
										</div>
									</div>
									
								</div>
								
								<!-- Transform Scale -->
								<div id="editor-selected-objects-transform-scale" class="my-2" style="display: none;">
									
									<!-- Transform Scale Inputs -->
									<div class="d-flex flex-wrap flex-sm-nowrap justify-content-center mb-3">
										<div class="flex-fill mx-1">
											<label class="mt-1 small">X: </label>
											<input id="editor-selected-objects-transform-scale-x" class="percent-input form-control form-control-sm" placeholder="X" type="text"
											data-bs-title="X-axis scale." data-bs-toggle="tooltip">
										</div>
										<div class="flex-fill mx-1">
											<label class="mt-1 small">Y: </label>
											<input id="editor-selected-objects-transform-scale-y" class="percent-input form-control form-control-sm" placeholder="Y" type="text"
											data-bs-title="Y-axis scale." data-bs-toggle="tooltip">
										</div>
										<div class="flex-fill mx-1">
											<label class="mt-1 small">Z: </label>
											<input id="editor-selected-objects-transform-scale-z" class="percent-input form-control form-control-sm" placeholder="Z" type="text"
											data-bs-title="Z-axis scale." data-bs-toggle="tooltip">
										</div>
									</div>
									
									<!-- Transform Scale Snap-To-Grid -->
									<div class="d-flex flex-row-reverse">
										<div class="text-end">
											<input id="editor-selected-objects-transform-scale-snap-checkbox" class="btn-check float-end" type="checkbox" checked>
											<label for="editor-selected-objects-transform-scale-snap-checkbox" class="btn btn-outline-secondary px-1 py-0 mt-2px float-end"
											data-bs-title="Enable/disable snap-to-grid." data-bs-toggle="tooltip" data-bs-placement="bottom">
												<i class="bi bi-grid-3x3"></i>
											</label>
											<input id="editor-selected-objects-transform-scale-snap" class="form-control form-control-sm w-36px px-1 mx-1 float-end" type="text"
											data-bs-title="Scale snap-to-grid amount." data-bs-toggle="tooltip" data-bs-placement="bottom">
										</div>
									</div>
									
								</div>
								
								<!-- Transform Rotation -->
								<div id="editor-selected-objects-transform-rotation" class="my-2" style="display: none;">
									
									<!-- Transform Rotation Inputs -->
									<div class="d-flex flex-wrap flex-sm-nowrap justify-content-center mb-3">
										<div class="flex-fill mx-1">
											<label class="mt-1 small">X: </label>
											<input id="editor-selected-objects-transform-rotation-x" class="degree-input form-control form-control-sm" placeholder="X" type="text"
											data-bs-title="X-axis rotation." data-bs-toggle="tooltip">
										</div>
										<div class="flex-fill mx-1">
											<label class="mt-1 small">Y: </label>
											<input id="editor-selected-objects-transform-rotation-y" class="degree-input form-control form-control-sm" placeholder="Y" type="text"
											data-bs-title="Y-axis rotation." data-bs-toggle="tooltip">
										</div>
										<div class="flex-fill mx-1">
											<label class="mt-1 small">Z: </label>
											<input id="editor-selected-objects-transform-rotation-z" class="degree-input form-control form-control-sm" placeholder="Z" type="text"
											data-bs-title="Z-axis rotation." data-bs-toggle="tooltip">
										</div>
									</div>
									
									<!-- Transform Rotation Snap-To-Grid -->
									<div class="d-flex flex-row-reverse">
										<div class="text-end">
											<input id="editor-selected-objects-transform-rotation-snap-checkbox" class="btn-check float-end" type="checkbox" checked>
											<label for="editor-selected-objects-transform-rotation-snap-checkbox" class="btn btn-outline-secondary px-1 py-0 mt-2px float-end"
											data-bs-title="Enable/disable snap-to-grid." data-bs-toggle="tooltip" data-bs-placement="bottom">
												<i class="bi bi-grid-3x3"></i>
											</label>
											<input id="editor-selected-objects-transform-rotation-snap" class="form-control form-control-sm w-36px px-1 mx-1 float-end" type="text"
											data-bs-title="Rotation snap-to-grid amount." data-bs-toggle="tooltip" data-bs-placement="bottom">
										</div>
									</div>
									
								</div>
								
							</div>
							
						</div>
						
						<!-- Materials -->
						<div class="accordion-item">
						
							<!-- Materials Title -->
							<div class="card-title accordion-title w-100 mt-2 mb-0">
								<button class="accordion-button collapsed small-important fw-bold p-0 m-0" type="button" data-bs-toggle="collapse" data-bs-target="#editor-selected-objects-materials" aria-expanded="true" aria-controls="editor-selected-objects-materials">
									<span data-bs-title="Change colours/textures." data-bs-toggle="tooltip" data-bs-placement="bottom">
										Materials
									</span>
								</button>
							</div>
							
							<div id="editor-selected-objects-materials" class="accordion-collapse collapse p-2">
								
								<!-- Material Colour Picker -->
								<div id="editor-selected-objects-materials-colour-picker" class="pb-2 mb-2 border-bottom">
									<div class="editor-selected-objects-materials-colour-grid mt-1 mb-2"></div>
									<div class="editor-selected-objects-materials-colour-info my-1">
										<input id="editor-selected-objects-materials-selected-colour" class="form-control form-control-color" value="#CCCCCC" type="color"
										data-bs-title="Pick a custom colour." data-bs-toggle="tooltip" data-bs-placement="bottom">
									</div>
									
									<!-- Material Texture Remove -->
									<div class="d-flex flex-row-reverse w-100">
										<div class="text-end">
											<label id="editor-selected-objects-materials-texture-reset-button" class="btn btn-outline-secondary px-1 py-0 mt-2px float-end"
											data-bs-title="Remove current texture." data-bs-toggle="tooltip" data-bs-placement="bottom">
												<i class="bi bi-ban"></i>
											</label>
										</div>
									</div>
								</div>
								
								<!-- Material Texture Picker -->
								<div id="editor-selected-objects-materials-texture-picker" class="mt-3">
									<select id="editor-selected-objects-materials-texture-select" class="form-select form-select-sm"
									data-bs-title="Select a texture category." data-bs-toggle="tooltip" data-bs-placement="bottom"></select>
									<div class="editor-selected-objects-materials-texture-grid my-1"></div>
								</div>
								
							</div>
							
						</div>
						
					</div>
				</div>
			</div>
		</div>
		
	</div>
	
	
	<!-- Menu UIs -->
	
	<!-- Main Menu -->
	<div id="menu" class="modal modal-sheet bg-body-secondary p-4 py-md-5">
		<div class="modal-dialog">
			<div class="modal-content rounded-4 shadow">
				<div class="modal-body p-5">
					<div class="d-flex justify-content-center">
						<h2 class="fw-bold mb-3">Main Menu</h2>
					</div>
					<div class="d-flex mb-3 justify-content-center">
						<button id="start-game" type="button" class="btn btn-lg btn-secondary w-100">Start</button>
					</div>
					<div class="d-flex justify-content-center">
						<button id="exit-game" type="button" class="btn btn-lg btn-secondary w-100">Exit</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	
	<!-- Game UI Elements -->
	
	<!-- Player Crosshair -->
	<div class="crosshair"></div>
	
	
	<!-- three.js Renderer -->
	<div id="renderer"></div>
	
	
	<!-- Game JS -->
    <script type="module">
		
		// Game Imports
		
		// three.js Imports
		import * as THREE from './libraries/threejs/three.js';
		import { PointerLockControls } from './libraries/threejs/modules/PointerLockControls.js';
		import { TransformControls } from './libraries/threejs/modules/TransformControls.js';
		
		// Class Imports
		import Player from './classes/player.class.js';
		import World from './classes/world.class.js';
		import Editor from './classes/editor.class.js';
		import Debug from './classes/debug.class.js';
		import Utilities from './classes/utilities.class.js';
		import Billboard from './classes/billboard.class.js';
		
		
		// Game Declarations
		
		// three.js Game Renderer
        let renderer, render_once, stop_animating;
		
		// Game Player
		let player;
		
		// Game World
		let worlds, world, textures;
		
		// Game Utilities
		let utilities, editor, debug;
		
		
		// Game Functions
		
		/**
		 * Game Initialization - Initializes the game and starts the game loop.
		 */
		function init()
		{
			
			// Initialize utilities
			utilities = new Utilities();
			editor = new Editor();
			debug = new Debug();
			
			// Initialize three.js renderer
			renderer = new THREE.WebGLRenderer();
			renderer.setSize(window.innerWidth, window.innerHeight);
			render_once = false;
			stop_animating = false;
			$('#renderer').append(renderer.domElement);
			
			// Initialize textures
			textures = {};
			
			// Initialize worlds
			worlds = {};
			
			// Load textures
			fetch('./textures/textures.json').then(response => response.json()).then(texture_paths => { utilities.loadTextures(texture_paths, textures, function() {
				
				// Load worlds
				fetch('./worlds/worlds.json').then(response => response.json()).then(worlds => {
										
					// Initialize world
					world = new World();
					world.load(worlds.TestWorld)
					
					// Initialize player
					player = new Player(window, document, renderer, textures, world, editor, debug);
					
					// Start game loop
					animate();
					
				}).catch(error => {
					
					// Error loading worlds
					console.error("Error loading worlds.json: ", error);
					
				});
				
			}); }).catch(error => {
				
				// Error loading textures
				console.error("Error loading textures.json: ", error);
				
			});
			
		}
		
		/**
		 * Game Loop - Updates game processes that update every frame, then renders the frame.
		 */
		function animate()
		{
			
			// Request a frame to be rendered using this method as a callback
			const frame_id = requestAnimationFrame(animate);
			
			// Make sure at least one frame is rendered (This is workaround for collision bounding boxes before handling ANY collision detection...)
			//
			// 	NOTE: One frame must be initially rendered because the THREE.Box3().setFromObject() function expects objects to have a 
			//	      matrixWorld property that is up-to-date first, so rendering a single frame before collision detection prevents a crash.
			if (render_once)
			{
				
				// Update the player (movement, collision detection, etc.)
				player.update(world);
				
				// Update in-game editor
				editor.update(world, player);
				
				// Update in-game debugger
				debug.update(world, player);
				
			}
			else
			{
				render_once = true;
			}
			
			// Render the frame (or break game loop if flag is set)
			if (!stop_animating)
			{
				renderer.render(world.scene, player.camera);
			}
			else
			{
				cancelAnimationFrame(frame_id);
				
				// TODO: Game loop broken. Do something? Show main menu?
			}
			
		}
		
		
		// Browser Window Event Handlers
		
		/**
		 * Window load event.
		 */
		window.onload = function(e)
		{ 
			
			// Initialize bootstrap tooltips
			$('[data-bs-toggle="tooltip"]').each(function() { let tooltip = new bootstrap.Tooltip($(this)); $(this).on('click', function() { tooltip.hide(); }); });
			
			
			// ---------------- TODO: REMOVE EVERYTHING BETWEEN THESE LINES  ----------------
			
            $('#menu').hide();
            init();
			setTimeout(function() { editor.toggle(textures, world, player); }, 500)
			
			// ---------------- TODO: REMOVE EVERYTHING BETWEEN THESE LINES  ----------------
			
		}
		
		/**
		 * Window resize event.
		 */
		window.addEventListener('resize', () => {
			
			// Update player camera
            player.camera.aspect = window.innerWidth / window.innerHeight;
            player.camera.updateProjectionMatrix();
			
			// Update game renderer
            renderer.setSize(window.innerWidth, window.innerHeight);
			
			// Resized editor UI elements.
			editor.resize();
			
        });
		
		
		// Editor UI Events
		
		// Editor Title Window
		
		/**
		 * Editor world name text change event.
		 */
		$("#editor-world-name").change(function()
		{
			if (editor.enabled)
			{
				
				// Set world name
				world.name = $("#editor-world-name").val();
				
			}
		});
		
		// Editor New/Load/Save World
		
		/**
		 * Editor world new button click event.
		 */
		$("#editor-world-new").click(function()
		{
			if (editor.enabled)
			{
				
				// Create a new empty world
				editor.newWorld(textures, world, player);
				
			}
		});
		
		/**
		 * Editor world load button click event.
		 */
		$("#editor-world-load").click(function()
		{
			if (editor.enabled)
			{
				
				// Load a world from a JSON file
				editor.loadWorld(world, player);
				
			}
		});
		
		/**
		 * Editor world save button click event.
		 */
		$("#editor-world-save").click(function()
		{
			if (editor.enabled)
			{
				
				// Save the selected world as a JSON file
				editor.saveWorld(world, player);
				
			}
		});
		
		// Editor Spawn Objects
		
		/**
		 * Editor world spawn billboard button click event.
		 */
		$("#editor-world-geometry-billboard").click(function()
		{
			if (editor.enabled)
			{
				
				// Spawn a new billboard
				editor.spawn(Billboard, textures, world, player)
				
			}
		});
		
		/**
		 * Editor world spawn plane button click event.
		 */
		$("#editor-world-geometry-plane").click(function()
		{
			if (editor.enabled)
			{
				
				// Spawn a new plane
				editor.spawn(THREE.PlaneGeometry, world, player)
				
			}
		});
		
		/**
		 * Editor world spawn box button click event.
		 */
		$("#editor-world-geometry-box").click(function()
		{
			if (editor.enabled)
			{
				
				// Spawn a new box
				editor.spawn(THREE.BoxGeometry, world, player)
				
			}
		});
		
		/**
		 * Editor world spawn cylinder button click event.
		 */
		$("#editor-world-geometry-cylinder").click(function()
		{
			if (editor.enabled)
			{
				
				// Spawn a new cylinder
				editor.spawn(THREE.CylinderGeometry, world, player)
				
			}
		});
		
		/**
		 * Editor world spawn sphere button click event.
		 */
		$("#editor-world-geometry-sphere").click(function()
		{
			if (editor.enabled)
			{
				
				// Spawn a new sphere
				editor.spawn(THREE.SphereGeometry, world, player)
				
			}
		});
		
		
		// Editor Selected Object Window
		
		/**
		 * Editor selected object transform type selected radio button change event.
		 */
		$('input[type="radio"][name="editor-selected-objects-transforms"]').change(function()
		{
			
			// Get editor selected object transform type selected radio button value
			let selectedValue = $(this).val();
			
			// Hide all transform controls
			$("#editor-selected-objects-transform-position").hide();
			$("#editor-selected-objects-transform-scale").hide();
			$("#editor-selected-objects-transform-rotation").hide();

			// Change player transform controls mode based on selected radio button value
			if (selectedValue === 'position')
			{
				
				// Translate mode
				player.controls.transform_controls.setMode('translate');
				
				// Show translate controls
				$("#editor-selected-objects-transform-position").show();
				
			}
			else if (selectedValue === 'scale')
			{
				
				// Scale mode
				player.controls.transform_controls.setMode('scale');
				
				// Show scale controls
				$("#editor-selected-objects-transform-scale").show();
				
			}
			else if (selectedValue === 'rotation')
			{
				
				// Rotate mode
				player.controls.transform_controls.setMode('rotate');
				
				// Show rotation controls
				$("#editor-selected-objects-transform-rotation").show();
				
			}
			
			// Update the editor selected object UI
			editor.updateSelectedObjectUI(player);
			
		});
		
		// Editor Selected Object Position
		
		/**
		 * Editor selected object position grid snap change event.
		 */
		 $("#editor-selected-objects-transform-position-snap").change(function()
		{
			if (editor.enabled)
			{
				
				// Check if position grid snap is enabled
				if ($("#editor-selected-objects-transform-position-snap-checkbox").prop("checked"))
				{
					
					// Set position grid snap
					player.controls.transform_controls.translationSnap = $("#editor-selected-objects-transform-position-snap").val();
					
				}
				
			}
		});
		
		/**
		 * Editor selected object position grid snap checkbox change event.
		 */
		 $("#editor-selected-objects-transform-position-snap-checkbox").change(function()
		{
			if (editor.enabled)
			{
				
				// Check if position grid snap is enabled
				if ($(this).prop("checked"))
				{
					
					// Set position grid snap
					player.controls.transform_controls.translationSnap = $("#editor-selected-objects-transform-position-snap").val();
					
				}
				else
				{
					
					// Disable position grid snap
					player.controls.transform_controls.translationSnap = null;
					
				}
				
			}
		});
		
		/**
		 * Editor selected object position X-axis change event.
		 */
		 $("#editor-selected-objects-transform-position-x").change(function()
		{
			if (editor.enabled)
			{
				
				// Set selected object X-axis position 
				editor.selected_object.position.x = $("#editor-selected-objects-transform-position-x").val();
				
			}
		});
		
		/**
		 * Editor selected object position Y-axis change event.
		 */
		 $("#editor-selected-objects-transform-position-y").change(function()
		{
			if (editor.enabled)
			{
				
				// Set selected object Y-axis position 
				editor.selected_object.position.y = $("#editor-selected-objects-transform-position-y").val();
				
			}
		});
		
		/**
		 * Editor selected object position Z-axis change event.
		 */
		 $("#editor-selected-objects-transform-position-z").change(function()
		{
			if (editor.enabled)
			{
				
				// Set selected object Z-axis position 
				editor.selected_object.position.z = $("#editor-selected-objects-transform-position-z").val();
				
			}
		});
		
		// Editor Selected Object Scale
		
		/**
		 * Editor selected object scale grid snap change event.
		 */
		 $("#editor-selected-objects-transform-scale-snap").change(function()
		{
			if (editor.enabled)
			{
				
				// Check if scale grid snap is enabled
				if ($("#editor-selected-objects-transform-scale-snap-checkbox").prop("checked"))
				{
					
					// Set scale grid snap
					player.controls.transform_controls.scaleSnap = $("#editor-selected-objects-transform-scale-snap").val();
					
				}
				
			}
		});
		
		/**
		 * Editor selected object scale grid snap checkbox change event.
		 */
		 $("#editor-selected-objects-transform-scale-snap-checkbox").change(function()
		{
			if (editor.enabled)
			{
				
				// Check if scale grid snap is enabled
				if ($(this).prop("checked"))
				{
					
					// Set scale grid snap
					player.controls.transform_controls.scaleSnap = $("#editor-selected-objects-transform-scale-snap").val();
					
				}
				else
				{
					
					// Disable scale grid snap
					player.controls.transform_controls.scaleSnap = null;
					
				}
				
			}
		});
		
		/**
		 * Editor selected object scale X-axis change event.
		 */
		 $("#editor-selected-objects-transform-scale-x").change(function()
		{
			if (editor.enabled)
			{
				
				// Set selected object X-axis scale 
				editor.selected_object.scale.x = $("#editor-selected-objects-transform-scale-x").val().slice(0, -1) / 100;
				
			}
		});
		
		/**
		 * Editor selected object scale Y-axis change event.
		 */
		 $("#editor-selected-objects-transform-scale-y").change(function()
		{
			if (editor.enabled)
			{
				
				// Set selected object Y-axis scale 
				editor.selected_object.scale.y = $("#editor-selected-objects-transform-scale-y").val().slice(0, -1) / 100;
				
			}
		});
		
		/**
		 * Editor selected object scale Z-axis change event.
		 */
		 $("#editor-selected-objects-transform-scale-z").change(function()
		{
			if (editor.enabled)
			{
				
				// Set selected object Z-axis scale 
				editor.selected_object.scale.z = $("#editor-selected-objects-transform-scale-z").val().slice(0, -1) / 100;
				
			}
		});
		
		// Editor Selected Object Rotation
		
		/**
		 * Editor selected object rotation grid snap change event.
		 */
		 $("#editor-selected-objects-transform-rotation-snap").change(function()
		{
			if (editor.enabled)
			{
				
				// Check if rotation grid snap is enabled
				if ($("#editor-selected-objects-transform-rotation-snap-checkbox").prop("checked"))
				{
					
					// Set rotation grid snap
					player.controls.transform_controls.rotationSnap = $("#editor-selected-objects-transform-rotation-snap").val();
					
				}
				
			}
		});
		
		/**
		 * Editor selected object rotation grid snap checkbox change event.
		 */
		 $("#editor-selected-objects-transform-rotation-snap-checkbox").change(function()
		{
			if (editor.enabled)
			{
				
				// Check if rotation grid snap is enabled
				if ($(this).prop("checked"))
				{
					
					// Set rotation grid snap
					player.controls.transform_controls.rotationSnap = $("#editor-selected-objects-transform-rotation-snap").val();
					
				}
				else
				{
					
					// Disable rotation grid snap
					player.controls.transform_controls.rotationSnap = null;
					
				}
				
			}
		});
		
		/**
		 * Editor selected object rotation X-axis change event.
		 */
		 $("#editor-selected-objects-transform-rotation-x").change(function()
		{
			if (editor.enabled)
			{
				
				// Set selected object X-axis rotation by converting the input degrees to radians
				editor.selected_object.rotation.x = $("#editor-selected-objects-transform-rotation-x").val().slice(0, -1) * (Math.PI / 180);
				
			}
		});
		
		/**
		 * Editor selected object rotation Y-axis change event.
		 */
		 $("#editor-selected-objects-transform-rotation-y").change(function()
		{
			if (editor.enabled)
			{
				
				// Set selected object Y-axis rotation by converting the input degrees to radians
				editor.selected_object.rotation.y = $("#editor-selected-objects-transform-rotation-y").val().slice(0, -1)  * (Math.PI / 180);
				
			}
		});
		
		/**
		 * Editor selected object rotation Z-axis change event.
		 */
		 $("#editor-selected-objects-transform-rotation-z").change(function()
		{
			if (editor.enabled)
			{
				
				// Set selected object Z-axis rotation by converting the input degrees to radians
				editor.selected_object.rotation.z = $("#editor-selected-objects-transform-rotation-z").val().slice(0, -1)  * (Math.PI / 180);
				
			}
		});
		
		/**
		 * Editor selected object colour picker input event.
		 */
		$("#editor-selected-objects-materials-selected-colour").on('input', function()
		{
			if (editor.enabled)
			{
				
				// Get hex string of the selected colour
				const selected_colour = $(this).val();
				
				// Set the selected object's colour to the new colour
				if (editor.selected_object)
				{
					editor.selected_object.material = editor.selected_object_original_materials.get(editor.selected_object);
					editor.selected_object.material.color.set(new THREE.Color(selected_colour));
					editor.selected_object_original_materials.set(editor.selected_object, editor.selected_object.material);
					editor.selected_object.material = new THREE.MeshBasicMaterial({ color: new THREE.Color(selected_colour), wireframe: true });
				}
				
			}
		});
		
		/**
		 * Editor selected object texture reset button click event.
		 */
		$("#editor-selected-objects-materials-texture-reset-button").click(function()
		{
			if (editor.enabled)
			{
				
				// Get hex string of the editor's default spawned object colour
				const selected_colour = "#" + editor.spawned_object_colour.toString(16);
				
				// Set the selected colour picker to the new colour
				$('#editor-selected-objects-materials-selected-colour').css('background-color', selected_colour);
				$('#editor-selected-objects-materials-selected-colour').val(selected_colour);
				
				// Set the selected object's colour to the new colour
				if (editor.selected_object)
				{
					editor.highlighted_object_original_materials.delete(editor.selected_object);
					editor.selected_object.material = editor.selected_object_original_materials.get(editor.selected_object);
					editor.selected_object.material = new THREE.MeshBasicMaterial({ color: new THREE.Color(selected_colour) });
					editor.selected_object_original_materials.set(editor.selected_object, editor.selected_object.material);
					editor.selected_object.material = new THREE.MeshBasicMaterial({ color: new THREE.Color(selected_colour), wireframe: true });
				}
				
			}
		});
		
		
		// Utility Class Events
		
		/**
		 * Letter input textbox text input event.
		 */
		$('.letter-input').on('input', function()
		{
			
			// Get just the letters from the element
			let value = $(this).val().replace(/[^a-zA-Z]/g, '');
			
			// Set the input to the text value
			$(this).val(value);
			
		});
		
		/**
		 * Number input textbox text input event.
		 */
		$('.number-input').on('input', function()
		{
			
			// Get just the numeric value from the element allowing a single decimal place
			let value = $(this).val().replace(/[^0-9.]/g, '');
			
			// Remove any extra decimal places
			if ((value.match(/\./g) || []).length > 1)
			{
				value = value.replace(/\.$/, '');
			}
			
			// Set the input to the numeric value
			$(this).val(value);
			
		});
		
		/**
		 * Percentage input textbox text input event.
		 */
		$('.percent-input').on('input', function()
		{
			
			// Get the input element
			let input = $(this)[0];
			
			// Get just the numeric value from the element
			let value = $(this).val().replace(/[^\d]/g, '');
			
			// Check the input for a value...
			if (value !== '')
			{
				
				// Add % to end of the input
				$(this).val(value + '%');
				input.setSelectionRange(value.length, value.length);
				
			}
			else
			{
				
				// Clear the input
				$(this).val('');
				
			}
			
		});
		
		/**
		 * Percentage input textbox focus event.
		 */
		$('.percent-input').on('focus', function()
		{
			
			// Remove the % when the input is clicked
			let value = $(this).val().replace('%', '');
			$(this).val(value);
			
		});
		
		/**
		 * Percentage input textbox un-focus event.
		 */
		$('.percent-input').on('blur', function()
		{
			
			// Get just the numeric value from the element
			let value = $(this).val().replace(/[^\d]/g, '');
			
			// Check the input for a value...
			if (value !== '')
			{
				
				// Add the % when the input is un-focused
				$(this).val(value + '%');
				
			}
			
		});
		
		/**
		 * Degree input textbox text input event.
		 */
		$('.degree-input').on('input', function()
		{
			
			// Get the input element
			let input = $(this)[0];
			
			// Get just the numeric value from the element
			let value = $(this).val().replace(/[^\d]/g, '');
			
			// Check the input for a value...
			if (value !== '')
			{
				
				// Add ° to end of the input
				$(this).val(value + '°');
				input.setSelectionRange(value.length, value.length);
				
			}
			else
			{
				
				// Clear the input
				$(this).val('');
				
			}
			
		});
		
		/**
		 * Degree input textbox focus event.
		 */
		$('.degree-input').on('focus', function()
		{
			
			// Remove the ° when the input is clicked
			let value = $(this).val().replace('°', '');
			$(this).val(value);
			
		});
		
		/**
		 * Degree input textbox un-focus event.
		 */
		$('.degree-input').on('blur', function()
		{
			
			// Get just the numeric value from the element
			let value = $(this).val().replace(/[^\d]/g, '');
			
			// Check the input for a value...
			if (value !== '')
			{
				
				// Add the ° when the input is un-focused
				$(this).val(value + '°');
				
			}
			
		});
		
		
		// Main Menu UI Events
		
		/**
		 * Start button click event.
		 */
        $("#start-game").click(function()
		{
			
			// Hide main menu UI
            $('#menu').hide();
			
			// Initialize game
            init();
			
		});
		
		/**
		 * Exit button click event.
		 */
		 $("#exit-game").click(function()
		{
			
			// Close browser
            window.close();
			
		});
        
    </script>
	
</body>
</html>